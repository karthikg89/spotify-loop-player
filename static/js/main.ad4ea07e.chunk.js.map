{"version":3,"sources":["Shortcuts.js","App.js","index.js"],"names":["Shortcuts","React","createElement","className","spotifyApi","SpotifyWebApi","App","token","setToken","useState","player","setPlayer","currentTrack","setCurrentTrack","loopStart","setLoopStart","loopEnd","setLoopEnd","isLooping","setIsLooping","currentTime","setCurrentTime","duration","setDuration","isDragging","setIsDragging","playerState","setPlayerState","showLoopControls","setShowLoopControls","loopStartRef","useRef","loopEndRef","justFinishedDragging","useEffect","hash","window","location","substring","split","reduce","initial","item","parts","decodeURIComponent","access_token","setAccessToken","document","getElementById","script","id","src","async","body","appendChild","onSpotifyWebPlaybackSDKReady","Spotify","Player","name","getOAuthToken","cb","addListener","_ref","device_id","console","log","transferMyPlayback","connect","state","track_window","current_track","artist","artists","uri","timeInterval","setInterval","getCurrentState","position","seek","catch","err","error","clearInterval","adjustLoopStart","useCallback","adjustment","newStart","Math","min","adjustLoopEnd","newEnd","max","handleNextTrack","nextTrack","handlePreviousTrack","previousTrack","handlePlayPause","paused","resume","pause","handleRestartLoop","handleKeyPress","e","target","tagName","code","preventDefault","ctrlKey","metaKey","shiftKey","addEventListener","removeEventListener","formatCurrentTime","ms","floor","toString","padStart","formatLoopTime","minutes","seconds","hundredths","handleLoopPointMouseDown","point","handleMouseMove","rect","querySelector","getBoundingClientRect","timePosition","clientX","left","width","handleMouseUp","current","setTimeout","style","display","justifyContent","marginBottom","onClick","currentTarget","clickPosition","clickTime","endPosition","tolerance","abs","height","background","cursor","borderRadius","margin","top","border","zIndex","onMouseDown","marginTop","Fragment","color","fontWeight","title","transform","type","ref","value","onChange","newValue","Number","gap","alignItems","aria-label","handleLogin","href","encodeURIComponent","join","ReactDOM","createRoot","render","StrictMode"],"mappings":"wQAoCeA,MAjCGA,IAEdC,IAAAC,cAAA,OAAKC,UAAU,uBACbF,IAAAC,cAAA,OAAKC,UAAU,oBACbF,IAAAC,cAAA,UAAI,sBACJD,IAAAC,cAAA,QAAMC,UAAU,SAAQ,WAE1BF,IAAAC,cAAA,OAAKC,UAAU,kBACbF,IAAAC,cAAA,UACED,IAAAC,cAAA,UACED,IAAAC,cAAA,QAAMC,UAAU,OAAM,SAAY,gBAEpCF,IAAAC,cAAA,UACED,IAAAC,cAAA,QAAMC,UAAU,OAAM,cAAiB,sCAEzCF,IAAAC,cAAA,UACED,IAAAC,cAAA,QAAMC,UAAU,OAAM,eAAkB,qCAE1CF,IAAAC,cAAA,UACED,IAAAC,cAAA,QAAMC,UAAU,OAAM,sBAAyB,oCAEjDF,IAAAC,cAAA,UACED,IAAAC,cAAA,QAAMC,UAAU,OAAM,uBAA0B,mCAElDF,IAAAC,cAAA,UACED,IAAAC,cAAA,QAAMC,UAAU,OAAM,KAAQ,qBCvB1C,MAAMC,EAAa,IAAIC,IAghBRC,MA9gBf,WACE,MAAOC,EAAOC,GAAYC,mBAAS,OAC5BC,EAAQC,GAAaF,mBAAS,OAC9BG,EAAcC,GAAmBJ,mBAAS,OAC1CK,EAAWC,GAAgBN,mBAAS,IACpCO,EAASC,GAAcR,mBAAS,IAChCS,EAAWC,GAAgBV,oBAAS,IACpCW,EAAaC,GAAkBZ,mBAAS,IACxCa,EAAUC,GAAed,mBAAS,IAClCe,EAAYC,GAAiBhB,mBAAS,OACtCiB,EAAaC,GAAkBlB,mBAAS,OACxCmB,EAAkBC,GAAuBpB,oBAAS,GAEnDqB,EAAeC,iBAAO,MACtBC,EAAaD,iBAAO,MACpBE,EAAuBF,kBAAO,GAEpCG,oBAAU,KAER,MAAMC,EAAOC,OAAOC,SAASF,KAC1BG,UAAU,GACVC,MAAM,KACNC,OAAO,CAACC,EAASC,KAChB,IAAIC,EAAQD,EAAKH,MAAM,KAEvB,OADAE,EAAQE,EAAM,IAAMC,mBAAmBD,EAAM,IACtCF,GACN,IAEDN,EAAKU,eACPrC,EAAS2B,EAAKU,cACdzC,EAAW0C,eAAeX,EAAKU,gBAEhC,IAEHX,oBAAU,KACR,GAAK3B,IAGAwC,SAASC,eAAe,kBAAmB,CAC9C,MAAMC,EAASF,SAAS7C,cAAc,UACtC+C,EAAOC,GAAK,iBACZD,EAAOE,IAAM,wCACbF,EAAOG,OAAQ,EACfL,SAASM,KAAKC,YAAYL,GAE1Bb,OAAOmB,6BAA+B,MACpC,MAAM7C,EAAS,IAAI0B,OAAOoB,QAAQC,OAAO,CACvCC,KAAM,cACNC,cAAeC,IAAQA,EAAGrD,MAG5BG,EAAOmD,YAAY,QAASC,IAAmB,IAAlBC,UAAEA,GAAWD,EACxCE,QAAQC,IAAI,uBAAwBF,GAEpC3D,EAAW8D,mBAAmB,CAACH,MAGjCrD,EAAOyD,UACPxD,EAAUD,OAGb,CAACH,IAGJ2B,oBAAU,KACJxB,GACFA,EAAOmD,YAAY,uBAAyBO,IACtCA,IACFzC,EAAeyC,GACfvD,EAAgB,CACd6C,KAAMU,EAAMC,aAAaC,cAAcZ,KACvCa,OAAQH,EAAMC,aAAaC,cAAcE,QAAQ,GAAGd,KACpDpC,SAAU8C,EAAM9C,SAChBmD,IAAKL,EAAMC,aAAaC,cAAcG,MAExClD,EAAY6C,EAAM9C,cAIvB,CAACZ,EAAQE,IAGZsB,oBAAU,KACR,GAAIxB,EAAQ,CACV,MAAMgE,EAAeC,YAAYvB,UAC/B,MAAMgB,QAAc1D,EAAOkE,kBACvBR,IACF/C,EAAe+C,EAAMS,UAGjB3D,GAAakD,EAAMS,UAAY7D,IAAYQ,GAC7Cd,EAAOoE,KAAKhE,GAAWiE,MAAMC,GAAOhB,QAAQiB,MAAM,cAAeD,MAGpE,KAEH,MAAO,IAAME,cAAcR,KAE5B,CAAChE,EAAQQ,EAAWJ,EAAWE,EAASQ,IAG3C,MAAM2D,EAAkBC,sBAAaC,IACnC,MAAMC,EAAWC,KAAKC,IAAI1E,EAAYuE,EAAYrE,GAClDD,EAAauE,GAET5E,GACFA,EAAOoE,KAAKQ,GAAUP,MAAMC,GAAOhB,QAAQiB,MAAM,cAAeD,KAEjE,CAAClE,EAAWE,EAASD,EAAcL,IAEhC+E,EAAgBL,sBAAaC,IACjC,MAAMK,EAASH,KAAKI,IAAI3E,EAAUqE,EAAYvE,GAC9CG,EAAWyE,IACV,CAAC1E,EAASF,EAAWG,IAElB2E,EAAkBR,sBAAYhC,UAC7B1C,IACLS,GAAa,SACPT,EAAOmF,cACZ,CAACnF,EAAQS,IAEN2E,EAAsBV,sBAAYhC,UACjC1C,IACLS,GAAa,SACPT,EAAOqF,kBACZ,CAACrF,EAAQS,IAEN6E,EAAkBZ,sBAAYhC,UAClC,IAAK1C,EAAQ,OACb,MAAM0D,QAAc1D,EAAOkE,mBAClB,OAALR,QAAK,IAALA,OAAK,EAALA,EAAO6B,cACHvF,EAAOwF,eAEPxF,EAAOyF,SAEd,CAACzF,IAGE0F,EAAoBhB,sBAAY,KAChC1E,GACFA,EAAOoE,KAAKhE,GAAWiE,MAAMC,GAAOhB,QAAQiB,MAAM,cAAeD,KAElE,CAACtE,EAAQI,IAGZoB,oBAAU,KACR,MAAMmE,EAAkBC,IACtB,GAAyB,UAArBA,EAAEC,OAAOC,SAA4C,aAArBF,EAAEC,OAAOC,QAI7C,OAAOF,EAAEG,MACP,IAAK,QACHH,EAAEI,iBACFV,IACA,MACF,IAAK,OACHM,EAAEI,iBACFN,IACA,MACF,IAAK,aACCE,EAAEK,SAAWL,EAAEM,SACjBN,EAAEI,iBACFd,KACSU,EAAEO,UACXP,EAAEI,iBACFjB,EAjBa,MAmBba,EAAEI,iBACFvB,EApBa,KAsBf,MACF,IAAK,YACCmB,EAAEK,SAAWL,EAAEM,SACjBN,EAAEI,iBACFZ,KACSQ,EAAEO,UACXP,EAAEI,iBACFjB,GA7Ba,MA+Bba,EAAEI,iBACFvB,GAhCa,OA0CrB,OAFApC,SAAS+D,iBAAiB,UAAWT,GAE9B,KACLtD,SAASgE,oBAAoB,UAAWV,KAEzC,CAACL,EAAiBJ,EAAiBE,EAAqBX,EAAiBM,EAAeW,IAE3F,MAaMY,EAAqBC,MACT1B,KAAK2B,MAAMD,EAAK,QAChB1B,KAAK2B,MAAOD,EAAK,IAAS,KAEbE,WAAWC,SAAS,EAAG,OAGhDC,EAAkBJ,IACtB,MAAMK,EAAU/B,KAAK2B,MAAMD,EAAK,KAC1BM,EAAUhC,KAAK2B,MAAOD,EAAK,IAAS,KACpCO,EAAajC,KAAK2B,MAAOD,EAAK,IAAQ,IAE5C,SAAUK,KAAWC,EAAQJ,WAAWC,SAAS,EAAG,QAAQI,EAAWL,WAAWC,SAAS,EAAG,QA0B1FK,EAA2BA,CAACnB,EAAGoB,KACnCjG,EAAciG,GAEdpB,EAAEI,kBAGEiB,EAAmBrB,IACvB,IAAK9E,EAAY,OAEjB,MACMoG,EADW7E,SAAS8E,cAAc,aAClBC,wBAEhBC,EADWxC,KAAKI,IAAI,EAAGJ,KAAKC,IAAI,GAAIc,EAAE0B,QAAUJ,EAAKK,MAAQL,EAAKM,QACxC5G,EAEhC,GAAmB,UAAfE,EAAwB,CAC1B,MAAM8D,EAAWC,KAAKC,IAAIuC,EAAc/G,GACxCD,EAAauE,QACR,GAAmB,QAAf9D,EAAsB,CAC/B,MAAMkE,EAASH,KAAKI,IAAIoC,EAAcjH,GACtCG,EAAWyE,KAITyC,EAAgB/C,sBAAY,KACb,UAAf5D,GAA0BN,GAAaR,GAEzCA,EAAOoE,KAAKhE,GAAWiE,MAAMC,GAAOhB,QAAQiB,MAAM,cAAeD,IAEnE/C,EAAqBmG,SAAU,EAE/BC,WAAW,KACTpG,EAAqBmG,SAAU,GAC9B,KACH3G,EAAc,OACb,CAACD,EAAYN,EAAWR,EAAQI,IAenC,OAZAoB,oBAAU,KACR,GAAIV,EAIF,OAHAuB,SAAS+D,iBAAiB,YAAaa,GACvC5E,SAAS+D,iBAAiB,UAAWqB,GAE9B,KACLpF,SAASgE,oBAAoB,YAAaY,GAC1C5E,SAASgE,oBAAoB,UAAWoB,KAG3C,CAAC3G,EAAYmG,EAAiBQ,IAG/BlI,IAAAC,cAAA,OAAKC,UAAU,OACXI,EAGAN,IAAAC,cAAA,OAAKC,UAAU,oBACZS,GACCX,IAAAC,cAAA,OAAKC,UAAU,cACbF,IAAAC,cAAA,UAAKU,EAAa8C,MAClBzD,IAAAC,cAAA,UAAKU,EAAa2D,SAItBtE,IAAAC,cAAA,OAAKC,UAAU,sBAEbF,IAAAC,cAAA,OAAKoI,MAAO,CACVC,QAAS,OACTC,eAAgB,gBAChBC,aAAc,QAEdxI,IAAAC,cAAA,YAAO8G,EAAkB5F,IACzBnB,IAAAC,cAAA,YAAO8G,EAAkB1F,KAG3BrB,IAAAC,cAAA,OACEC,UAAU,WACVuI,QAlGiBpC,IAC3B,GAAIrE,EAAqBmG,QACvB,OAGF,MACMR,EADWtB,EAAEqC,cACGb,wBAChBc,GAAiBtC,EAAE0B,QAAUJ,EAAKK,MAAQL,EAAKM,MAC/CW,EAAYD,EAAgBtH,EAI5BwH,EAAe9H,EAAUM,EACzByH,EAAY,EAAInB,EAAKM,MAGvB3C,KAAKyD,IAAIJ,EAAgBE,GAAeC,GAI5CrI,EAAOoE,KAAK+D,IA+EFP,MAAO,CACLzD,SAAU,WACVoE,OAAQ,OACRC,WAAY,OACZC,OAAQ,UACRC,aAAc,OACdC,OAAQ,eAIVpJ,IAAAC,cAAA,OACEC,UAAU,WACVmI,MAAO,CACLzD,SAAU,WACVoD,KAAM,EACNqB,IAAK,EACLL,OAAQ,OACRf,SAAW9G,EAAcE,EAAY,OACrC4H,WAAY,UACZE,aAAc,UAKlBnJ,IAAAC,cAAA,OACEC,UAAU,cACVmI,MAAO,CACLzD,SAAU,WACVoD,QAAUnH,EAAYQ,EAAY,OAClC4G,UAAYlH,EAAUF,GAAaQ,EAAY,OAC/C2H,OAAQ,OACRC,WAAY,yBACZE,aAAc,UAKlBnJ,IAAAC,cAAA,OACEC,UAAU,aACVmI,MAAO,CACLzD,SAAU,WACVoD,QAAUnH,EAAYQ,EAAY,OAClC2H,OAAQ,OACRK,IAAK,QACLpB,MAAO,MACPgB,WAAY,UACZK,OAAQ,oBACRJ,OAAQ,YACRK,OAAQ,EACRJ,aAAc,OAEhBK,YAAcnD,GAAMmB,EAAyBnB,EAAG,WAElDrG,IAAAC,cAAA,OACEC,UAAU,WACVmI,MAAO,CACLzD,SAAU,WACVoD,QAAUjH,EAAUM,EAAY,OAChC2H,OAAQ,OACRK,IAAK,QACLpB,MAAO,MACPgB,WAAY,UACZK,OAAQ,oBACRJ,OAAQ,YACRK,OAAQ,EACRJ,aAAc,OAEhBK,YAAcnD,GAAMmB,EAAyBnB,EAAG,UAKpDrG,IAAAC,cAAA,OAAKC,UAAU,eAAemI,MAAO,CACnCzD,SAAU,WACVoE,OAAQ,OACRS,UAAW,SAEVnE,KAAKyD,KAAKhI,EAAUF,GAAaQ,GAAY,GAC5CrB,IAAAC,cAAAD,IAAA0J,SAAA,KACE1J,IAAAC,cAAA,OAAKC,UAAU,sBACbmI,MAAO,CACLL,QAAUnH,EAAYQ,EAAY,OAClCsI,MAAO,UACPC,WAAY,OACZV,OAAQ,WAEVW,MAAM,kEAEN7J,IAAAC,cAAA,YAAOmH,EAAevG,KAExBb,IAAAC,cAAA,OAAKC,UAAU,sBACbmI,MAAO,CACLL,QAAUjH,EAAUM,EAAY,OAChCsI,MAAO,UACPC,WAAY,OACZV,OAAQ,WAEVW,MAAM,kEAEN7J,IAAAC,cAAA,YAAOmH,EAAerG,MAI1Bf,IAAAC,cAAA,OAAKoI,MAAO,CACVzD,SAAU,WACVoD,SAAWnH,EAAYE,GAAW,EAAIM,EAAY,OAClDyI,UAAW,mBACXH,MAAO,UACPC,WAAY,SAEXxC,EAAevG,GAAW,MAAIuG,EAAerG,MAMrDY,GACC3B,IAAAC,cAAA,OAAKC,UAAU,eACbF,IAAAC,cAAA,aAAO,mBAELD,IAAAC,cAAA,SACE8J,KAAK,SACLC,IAAKnI,EACLoI,MAAOpJ,EACPqJ,SAAW7D,IACT,MAAM8D,EAAWC,OAAO/D,EAAEC,OAAO2D,OACjCnJ,EAAaqJ,GAET1J,GACFA,EAAOoE,KAAKsF,GAAUrF,MAAMC,GAAOhB,QAAQiB,MAAM,cAAeD,QAKxE/E,IAAAC,cAAA,aAAO,iBAELD,IAAAC,cAAA,SACE8J,KAAK,SACLC,IAAKjI,EACLkI,MAAOlJ,EACPmJ,SAAW7D,IACT,MAAM8D,EAAWC,OAAO/D,EAAEC,OAAO2D,OACjCjJ,EAAWmJ,GAEP1J,GACFA,EAAOoE,KAAKsF,GAAUrF,MAAMC,GAAOhB,QAAQiB,MAAM,cAAeD,SAQ5E/E,IAAAC,cAAA,OAAKC,UAAU,WAAWmI,MAAO,CAC/BoB,UAAW,OACXnB,QAAS,OACTC,eAAgB,SAChB8B,IAAK,OACLC,WAAY,WAEZtK,IAAAC,cAAA,UACEwI,QAAS5C,EACT3F,UAAU,iBACVqK,aAAW,iBACXV,MAAM,kBACP,UAID7J,IAAAC,cAAA,UACEwI,QAAS1C,EACT7F,UAAU,iBACVqK,aAAW,gBACXV,OAAkB,OAAXpI,QAAW,IAAXA,OAAW,EAAXA,EAAauE,QAAS,OAAS,UAE1B,OAAXvE,QAAW,IAAXA,OAAW,EAAXA,EAAauE,QAAS,SAAM,UAG/BhG,IAAAC,cAAA,UACEwI,QAAS9C,EACTzF,UAAU,iBACVqK,aAAW,aACXV,MAAM,cACP,UAID7J,IAAAC,cAAA,UACEwI,QAASA,IAAMvH,GAAcD,GAC7Bf,4BAA6Be,EAAY,SAAW,KACpDsJ,aAAW,cACXV,MAAO5I,EAAY,YAAc,cAClC,iBAIHjB,IAAAC,cAACF,EAAS,MAAG,KA5NfC,IAAAC,cAAA,UAAQwI,QAvGM+B,KAUlBrI,OAAOC,SAASqI,uGAAqFC,mBAPhF,8DAO0HA,mBANhI,CACb,2BACA,6BACA,aAGuKC,KAAK,8BA6F5I,wBC7SzBC,IAASC,WAAW/H,SAASC,eAAe,SACpD+H,OACH9K,IAAAC,cAACD,IAAM+K,WAAU,KACf/K,IAAAC,cAACI,EAAG","file":"static/js/main.ad4ea07e.chunk.js","sourcesContent":["import React from 'react';\nimport './Shortcuts.css'; // Create a separate CSS file for styling\n\nconst Shortcuts = () => {\n  return (\n    <div className=\"shortcuts-container\">\n      <div className=\"shortcuts-header\">\n        <h2>Keyboard Shortcuts</h2>\n        <span className=\"arrow\">‚ñº</span>\n      </div>\n      <div className=\"shortcuts-list\">\n        <ul>\n          <li>\n            <span className=\"key\">Space</span>: Play/Pause\n          </li>\n          <li>\n            <span className=\"key\">Arrow Left</span>: Move Start Loop Backward by 10ms\n          </li>\n          <li>\n            <span className=\"key\">Arrow Right</span>: Move Start Loop Forward by 10ms\n          </li>\n          <li>\n            <span className=\"key\">Shift + Arrow Left</span>: Move End Loop Backward by 10ms\n          </li>\n          <li>\n            <span className=\"key\">Shift + Arrow Right</span>: Move End Loop Forward by 10ms\n          </li>\n          <li>\n            <span className=\"key\">R</span>: Restart Loop\n          </li>\n        </ul>\n      </div>\n    </div>\n  );\n};\n\nexport default Shortcuts; ","import React, { useState, useEffect, useRef, useCallback } from 'react';\nimport SpotifyWebApi from 'spotify-web-api-js';\nimport './App.css';\nimport Shortcuts from './Shortcuts'; // Import the Shortcuts component\n\nconst spotifyApi = new SpotifyWebApi();\n\nfunction App() {\n  const [token, setToken] = useState(null);\n  const [player, setPlayer] = useState(null);\n  const [currentTrack, setCurrentTrack] = useState(null);\n  const [loopStart, setLoopStart] = useState(0);\n  const [loopEnd, setLoopEnd] = useState(0);\n  const [isLooping, setIsLooping] = useState(false);\n  const [currentTime, setCurrentTime] = useState(0);\n  const [duration, setDuration] = useState(0);\n  const [isDragging, setIsDragging] = useState(null); // 'start', 'end', or null\n  const [playerState, setPlayerState] = useState(null);\n  const [showLoopControls, setShowLoopControls] = useState(false);\n\n  const loopStartRef = useRef(null);\n  const loopEndRef = useRef(null);\n  const justFinishedDragging = useRef(false);\n\n  useEffect(() => {\n    // Get token from URL params (after Spotify auth redirect)\n    const hash = window.location.hash\n      .substring(1)\n      .split('&')\n      .reduce((initial, item) => {\n        let parts = item.split('=');\n        initial[parts[0]] = decodeURIComponent(parts[1]);\n        return initial;\n      }, {});\n\n    if (hash.access_token) {\n      setToken(hash.access_token);\n      spotifyApi.setAccessToken(hash.access_token);\n    }\n  }, []);\n\n  useEffect(() => {\n    if (!token) return; // Only proceed if we have a token\n    \n    // Check if script is already loaded\n    if (!document.getElementById('spotify-player')) {\n      const script = document.createElement(\"script\");\n      script.id = 'spotify-player'; // Add an ID to check for existence\n      script.src = \"https://sdk.scdn.co/spotify-player.js\";\n      script.async = true;\n      document.body.appendChild(script);\n\n      window.onSpotifyWebPlaybackSDKReady = () => {\n        const player = new window.Spotify.Player({\n          name: 'Loop Player',\n          getOAuthToken: cb => { cb(token); }\n        });\n\n        player.addListener('ready', ({ device_id }) => {\n          console.log('Ready with Device ID', device_id);\n          // Transfer playback to our player\n          spotifyApi.transferMyPlayback([device_id]);\n        });\n\n        player.connect();\n        setPlayer(player);\n      };\n    }\n  }, [token]);\n\n  // Update the track state listener useEffect\n  useEffect(() => {\n    if (player) {\n      player.addListener('player_state_changed', (state) => {\n        if (state) {\n          setPlayerState(state);\n          setCurrentTrack({\n            name: state.track_window.current_track.name,\n            artist: state.track_window.current_track.artists[0].name,\n            duration: state.duration,\n            uri: state.track_window.current_track.uri\n          });\n          setDuration(state.duration);\n        }\n      });\n    }\n  }, [player, currentTrack]);\n\n  // Update the loop checking useEffect\n  useEffect(() => {\n    if (player) {\n      const timeInterval = setInterval(async () => {\n        const state = await player.getCurrentState();\n        if (state) {\n          setCurrentTime(state.position);\n          \n          // Only seek to start position if looping is enabled and we're past the end\n          if (isLooping && state.position >= loopEnd && !isDragging) {\n            player.seek(loopStart).catch(err => console.error('Seek error:', err));\n          }\n        }\n      }, 100);\n\n      return () => clearInterval(timeInterval);\n    }\n  }, [player, isLooping, loopStart, loopEnd, isDragging]);\n\n  // Define the adjustment handlers with useCallback\n  const adjustLoopStart = useCallback((adjustment) => {\n    const newStart = Math.min(loopStart + adjustment, loopEnd);\n    setLoopStart(newStart);\n    // Always seek when adjusting start with arrow keys\n    if (player) {\n      player.seek(newStart).catch(err => console.error('Seek error:', err));\n    }\n  }, [loopStart, loopEnd, setLoopStart, player]);\n\n  const adjustLoopEnd = useCallback((adjustment) => {\n    const newEnd = Math.max(loopEnd + adjustment, loopStart);\n    setLoopEnd(newEnd);\n  }, [loopEnd, loopStart, setLoopEnd]);\n\n  const handleNextTrack = useCallback(async () => {\n    if (!player) return;\n    setIsLooping(false);\n    await player.nextTrack();\n  }, [player, setIsLooping]);\n\n  const handlePreviousTrack = useCallback(async () => {\n    if (!player) return;\n    setIsLooping(false);\n    await player.previousTrack();\n  }, [player, setIsLooping]);\n\n  const handlePlayPause = useCallback(async () => {\n    if (!player) return;\n    const state = await player.getCurrentState();\n    if (state?.paused) {\n      await player.resume();\n    } else {\n      await player.pause();\n    }\n  }, [player]);\n\n  // Add the restart loop handler with useCallback\n  const handleRestartLoop = useCallback(() => {\n    if (player) {\n      player.seek(loopStart).catch(err => console.error('Seek error:', err));\n    }\n  }, [player, loopStart]);\n\n  // Update the keyboard event listener useEffect to include the 'r' key\n  useEffect(() => {\n    const handleKeyPress = (e) => {\n      if (e.target.tagName === 'INPUT' || e.target.tagName === 'TEXTAREA') return;\n      \n      const adjustment = 10; // Fixed 10ms adjustment\n\n      switch(e.code) {\n        case 'Space':\n          e.preventDefault();\n          handlePlayPause();\n          break;\n        case 'KeyR': // Add handler for 'r' key\n          e.preventDefault();\n          handleRestartLoop();\n          break;\n        case 'ArrowRight':\n          if (e.ctrlKey || e.metaKey) {\n            e.preventDefault();\n            handleNextTrack();\n          } else if (e.shiftKey) {\n            e.preventDefault();\n            adjustLoopEnd(adjustment);\n          } else {\n            e.preventDefault();\n            adjustLoopStart(adjustment);\n          }\n          break;\n        case 'ArrowLeft':\n          if (e.ctrlKey || e.metaKey) {\n            e.preventDefault();\n            handlePreviousTrack();\n          } else if (e.shiftKey) {\n            e.preventDefault();\n            adjustLoopEnd(-adjustment);\n          } else {\n            e.preventDefault();\n            adjustLoopStart(-adjustment);\n          }\n          break;\n        default:\n          break;\n      }\n    };\n\n    document.addEventListener('keydown', handleKeyPress);\n    \n    return () => {\n      document.removeEventListener('keydown', handleKeyPress);\n    };\n  }, [handlePlayPause, handleNextTrack, handlePreviousTrack, adjustLoopStart, adjustLoopEnd, handleRestartLoop]);\n\n  const handleLogin = () => {\n    const CLIENT_ID = '90578a866be642ed97064a098d97fecd';\n    // const REDIRECT_URI = 'http://localhost:3000/callback'; // Ensure this matches the dashboard\n    const REDIRECT_URI = 'https://karthikg89.github.io/spotify-loop-player/'; // Old production URI\n    const scopes = [\n      'user-read-playback-state',\n      'user-modify-playback-state',\n      'streaming'\n    ];\n\n    window.location.href = `https://accounts.spotify.com/authorize?client_id=${CLIENT_ID}&redirect_uri=${encodeURIComponent(REDIRECT_URI)}&scope=${encodeURIComponent(scopes.join(' '))}&response_type=token`;\n  };\n\n  const formatCurrentTime = (ms) => {\n    const minutes = Math.floor(ms / 60000);\n    const seconds = Math.floor((ms % 60000) / 1000);\n\n    return `${minutes}:${seconds.toString().padStart(2, '0')}`; // Format as mm:ss\n  };\n\n  const formatLoopTime = (ms) => {\n    const minutes = Math.floor(ms / 60000);\n    const seconds = Math.floor((ms % 60000) / 1000);\n    const hundredths = Math.floor((ms % 1000) / 10);\n\n    return `${minutes}:${seconds.toString().padStart(2, '0')}:${hundredths.toString().padStart(2, '0')}`; // Format as mm:ss:hh\n  };\n\n  const handleTimelineClick = (e) => {\n    if (justFinishedDragging.current) {\n      return;\n    }\n\n    const timeline = e.currentTarget;\n    const rect = timeline.getBoundingClientRect();\n    const clickPosition = (e.clientX - rect.left) / rect.width;\n    const clickTime = clickPosition * duration;\n    \n    // Check if click is near either loop marker (within 2px)\n    const startPosition = (loopStart / duration);\n    const endPosition = (loopEnd / duration);\n    const tolerance = 2 / rect.width; // Convert 2px to percentage\n    \n    // Only block seeking if we're near the end marker\n    if (Math.abs(clickPosition - endPosition) < tolerance) {\n      return; // Don't seek if clicking near end marker\n    }\n    \n    player.seek(clickTime);\n  };\n\n  const handleLoopPointMouseDown = (e, point) => {\n    setIsDragging(point);\n    // Prevent text selection while dragging\n    e.preventDefault();\n  };\n\n  const handleMouseMove = (e) => {\n    if (!isDragging) return;\n\n    const timeline = document.querySelector('.timeline');\n    const rect = timeline.getBoundingClientRect();\n    const position = Math.max(0, Math.min(1, (e.clientX - rect.left) / rect.width));\n    const timePosition = position * duration;\n\n    if (isDragging === 'start') {\n      const newStart = Math.min(timePosition, loopEnd);\n      setLoopStart(newStart);\n    } else if (isDragging === 'end') {\n      const newEnd = Math.max(timePosition, loopStart);\n      setLoopEnd(newEnd);\n    }\n  };\n\n  const handleMouseUp = useCallback(() => {\n    if (isDragging === 'start' && isLooping && player) {\n      // Only seek to start position if we were dragging the start marker and looping is active\n      player.seek(loopStart).catch(err => console.error('Seek error:', err));\n    }\n    justFinishedDragging.current = true;\n    // Reset the flag after a short delay\n    setTimeout(() => {\n      justFinishedDragging.current = false;\n    }, 100);\n    setIsDragging(null);\n  }, [isDragging, isLooping, player, loopStart]);\n\n  // Add this useEffect to handle mouse events\n  useEffect(() => {\n    if (isDragging) {\n      document.addEventListener('mousemove', handleMouseMove);\n      document.addEventListener('mouseup', handleMouseUp);\n      \n      return () => {\n        document.removeEventListener('mousemove', handleMouseMove);\n        document.removeEventListener('mouseup', handleMouseUp);\n      };\n    }\n  }, [isDragging, handleMouseMove, handleMouseUp]);\n\n  return (\n    <div className=\"App\">\n      {!token ? (\n        <button onClick={handleLogin}>Login with Spotify</button>\n      ) : (\n        <div className=\"player-container\">\n          {currentTrack && (\n            <div className=\"track-info\">\n              <h2>{currentTrack.name}</h2>\n              <h3>{currentTrack.artist}</h3>\n            </div>\n          )}\n\n          <div className=\"timeline-container\">\n            {/* Move current time and duration above the timeline */}\n            <div style={{ \n              display: 'flex', \n              justifyContent: 'space-between',\n              marginBottom: '5px'\n            }}>\n              <span>{formatCurrentTime(currentTime)}</span>\n              <span>{formatCurrentTime(duration)}</span>\n            </div>\n\n            <div \n              className=\"timeline\" \n              onClick={handleTimelineClick}\n              style={{ \n                position: 'relative', \n                height: '40px', \n                background: '#ddd', \n                cursor: 'pointer',\n                borderRadius: '20px',\n                margin: '0 0 10px 0'  // Adjusted margin\n              }}\n            >\n              {/* Playback progress */}\n              <div \n                className=\"progress\"\n                style={{\n                  position: 'absolute',\n                  left: 0,\n                  top: 0,\n                  height: '100%',\n                  width: `${(currentTime / duration) * 100}%`,\n                  background: '#1db954',\n                  borderRadius: '20px'\n                }}\n              />\n              \n              {/* Loop region */}\n              <div \n                className=\"loop-region\"\n                style={{\n                  position: 'absolute',\n                  left: `${(loopStart / duration) * 100}%`,\n                  width: `${((loopEnd - loopStart) / duration) * 100}%`,\n                  height: '100%',\n                  background: 'rgba(29, 185, 84, 0.3)',\n                  borderRadius: '20px'\n                }}\n              />\n\n              {/* Loop markers */}\n              <div \n                className=\"loop-start\"\n                style={{\n                  position: 'absolute',\n                  left: `${(loopStart / duration) * 100}%`,\n                  height: '60px',\n                  top: '-10px',\n                  width: '4px',\n                  background: '#ffffff',\n                  border: '2px solid #1db954',\n                  cursor: 'ew-resize',\n                  zIndex: 2,\n                  borderRadius: '2px'\n                }}\n                onMouseDown={(e) => handleLoopPointMouseDown(e, 'start')}\n              />\n              <div \n                className=\"loop-end\"\n                style={{\n                  position: 'absolute',\n                  left: `${(loopEnd / duration) * 100}%`,\n                  height: '60px',\n                  top: '-10px',\n                  width: '4px',\n                  background: '#ffffff',\n                  border: '2px solid #1db954',\n                  cursor: 'ew-resize',\n                  zIndex: 2,\n                  borderRadius: '2px'\n                }}\n                onMouseDown={(e) => handleLoopPointMouseDown(e, 'end')}\n              />\n            </div>\n\n            {/* Loop timestamps only */}\n            <div className=\"time-display\" style={{ \n              position: 'relative',\n              height: '20px',\n              marginTop: '15px'\n            }}>\n              {Math.abs((loopEnd - loopStart) / duration) > 0.1 ? (\n                <>\n                  <div className=\"timestamp-container\" \n                    style={{ \n                      left: `${(loopStart / duration) * 100}%`,\n                      color: '#1db954',\n                      fontWeight: 'bold',\n                      cursor: 'default'\n                    }}\n                    title=\"Use arrow keys to adjust start, Shift+arrow keys to adjust end\"\n                  >\n                    <span>{formatLoopTime(loopStart)}</span>\n                  </div>\n                  <div className=\"timestamp-container\" \n                    style={{ \n                      left: `${(loopEnd / duration) * 100}%`,\n                      color: '#1db954',\n                      fontWeight: 'bold',\n                      cursor: 'default'\n                    }}\n                    title=\"Use arrow keys to adjust start, Shift+arrow keys to adjust end\"\n                  >\n                    <span>{formatLoopTime(loopEnd)}</span>\n                  </div>\n                </>\n              ) : (\n                <div style={{ \n                  position: 'absolute', \n                  left: `${((loopStart + loopEnd) / 2 / duration) * 100}%`,\n                  transform: 'translateX(-50%)',\n                  color: '#1db954',\n                  fontWeight: 'bold'\n                }}>\n                  {formatLoopTime(loopStart)} - {formatLoopTime(loopEnd)}\n                </div>\n              )}\n            </div>\n          </div>\n\n          {showLoopControls && (\n            <div className=\"loop-inputs\">\n              <label>\n                Loop Start (ms):\n                <input\n                  type=\"number\"\n                  ref={loopStartRef}\n                  value={loopStart}\n                  onChange={(e) => {\n                    const newValue = Number(e.target.value);\n                    setLoopStart(newValue);\n                    // Optionally, you can also seek to the new loop start position\n                    if (player) {\n                      player.seek(newValue).catch(err => console.error('Seek error:', err));\n                    }\n                  }}\n                />\n              </label>\n              <label>\n                Loop End (ms):\n                <input\n                  type=\"number\"\n                  ref={loopEndRef}\n                  value={loopEnd}\n                  onChange={(e) => {\n                    const newValue = Number(e.target.value);\n                    setLoopEnd(newValue);\n                    // Optionally, you can also seek to the new loop end position\n                    if (player) {\n                      player.seek(newValue).catch(err => console.error('Seek error:', err));\n                    }\n                  }}\n                />\n              </label>\n            </div>\n          )}\n\n          <div className=\"controls\" style={{ \n            marginTop: '20px',\n            display: 'flex',\n            justifyContent: 'center',\n            gap: '15px',\n            alignItems: 'center'\n          }}>\n            <button \n              onClick={handlePreviousTrack}\n              className=\"control-button\"\n              aria-label=\"Previous track\"\n              title=\"Previous Track\"\n            >\n              ‚èÆ\n            </button>\n            \n            <button \n              onClick={handlePlayPause} \n              className=\"control-button\"\n              aria-label=\"Play or pause\"\n              title={playerState?.paused ? \"Play\" : \"Pause\"}\n            >\n              {playerState?.paused ? \"‚ñ∂\" : \"‚è∏\"}\n            </button>\n            \n            <button \n              onClick={handleNextTrack}\n              className=\"control-button\"\n              aria-label=\"Next track\"\n              title=\"Next Track\"\n            >\n              ‚è≠\n            </button>\n\n            <button \n              onClick={() => setIsLooping(!isLooping)}\n              className={`control-button ${isLooping ? 'active' : ''}`}\n              aria-label=\"Toggle loop\"\n              title={isLooping ? \"Stop Loop\" : \"Start Loop\"}\n            >\n              üîÅ\n            </button>\n          </div>\n          <Shortcuts /> {/* Add the Shortcuts component here */}\n        </div>\n      )}\n    </div>\n  );\n}\n\nexport default App; ","import React from 'react';\nimport ReactDOM from 'react-dom/client';\nimport './index.css';\nimport App from './App';\n\nconst root = ReactDOM.createRoot(document.getElementById('root'));\nroot.render(\n  <React.StrictMode>\n    <App />\n  </React.StrictMode>\n);\n"],"sourceRoot":""}