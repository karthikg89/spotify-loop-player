(window.webpackJsonp=window.webpackJsonp||[]).push([[0],[,,,,function(e,t,a){e.exports=a(16)},,,,,,,,,function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),o=a(2),l=a.n(o),s=(a(13),a(3)),c=a.n(s);a(14),a(15);var i=()=>r.a.createElement("div",{className:"shortcuts-container"},r.a.createElement("div",{className:"shortcuts-header"},r.a.createElement("h2",null,"Keyboard Shortcuts"),r.a.createElement("span",{className:"arrow"},"\u25bc")),r.a.createElement("div",{className:"shortcuts-list"},r.a.createElement("ul",null,r.a.createElement("li",null,r.a.createElement("span",{className:"key"},"Space"),": Play/Pause"),r.a.createElement("li",null,r.a.createElement("span",{className:"key"},"Arrow Left"),": Move Start Loop Backward by 10ms"),r.a.createElement("li",null,r.a.createElement("span",{className:"key"},"Arrow Right"),": Move Start Loop Forward by 10ms"),r.a.createElement("li",null,r.a.createElement("span",{className:"key"},"Shift + Arrow Left"),": Move End Loop Backward by 10ms"),r.a.createElement("li",null,r.a.createElement("span",{className:"key"},"Shift + Arrow Right"),": Move End Loop Forward by 10ms"),r.a.createElement("li",null,r.a.createElement("span",{className:"key"},"R"),": Restart Loop"))));const u=new c.a;var d=function(){const[e,t]=Object(n.useState)(null),[a,o]=Object(n.useState)(null),[l,s]=Object(n.useState)(null),[c,d]=Object(n.useState)(0),[m,p]=Object(n.useState)(0),[b,f]=Object(n.useState)(!1),[y,h]=Object(n.useState)(0),[k,E]=Object(n.useState)(0),[v,w]=Object(n.useState)(null),[g,S]=Object(n.useState)(null),[j,N]=Object(n.useState)(!1),x=Object(n.useRef)(null),O=Object(n.useRef)(null),C=Object(n.useRef)(!1);Object(n.useEffect)(()=>{const e=window.location.hash.substring(1).split("&").reduce((e,t)=>{let a=t.split("=");return e[a[0]]=decodeURIComponent(a[1]),e},{});e.access_token&&(t(e.access_token),u.setAccessToken(e.access_token))},[]),Object(n.useEffect)(()=>{if(e&&!document.getElementById("spotify-player")){const t=document.createElement("script");t.id="spotify-player",t.src="https://sdk.scdn.co/spotify-player.js",t.async=!0,document.body.appendChild(t),window.onSpotifyWebPlaybackSDKReady=(()=>{const t=new window.Spotify.Player({name:"Loop Player",getOAuthToken:t=>{t(e)}});t.addListener("ready",e=>{let{device_id:t}=e;console.log("Ready with Device ID",t),u.transferMyPlayback([t])}),t.connect(),o(t)})}},[e]),Object(n.useEffect)(()=>{a&&a.addListener("player_state_changed",e=>{e&&(S(e),s({name:e.track_window.current_track.name,artist:e.track_window.current_track.artists[0].name,duration:e.duration,uri:e.track_window.current_track.uri}),E(e.duration))})},[a,l]),Object(n.useEffect)(()=>{if(a){const e=setInterval(async()=>{const e=await a.getCurrentState();e&&(h(e.position),b&&e.position>=m&&!v&&a.seek(c).catch(e=>console.error("Seek error:",e)))},100);return()=>clearInterval(e)}},[a,b,c,m,v]);const R=Object(n.useCallback)(e=>{const t=Math.min(c+e,m);d(t),a&&a.seek(t).catch(e=>console.error("Seek error:",e))},[c,m,d,a]),L=Object(n.useCallback)(e=>{const t=Math.max(m+e,c);p(t)},[m,c,p]),M=Object(n.useCallback)(async()=>{a&&(f(!1),await a.nextTrack())},[a,f]),$=Object(n.useCallback)(async()=>{a&&(f(!1),await a.previousTrack())},[a,f]),_=Object(n.useCallback)(async()=>{if(!a)return;const e=await a.getCurrentState();(null===e||void 0===e?void 0:e.paused)?await a.resume():await a.pause()},[a]),D=Object(n.useCallback)(()=>{a&&a.seek(c).catch(e=>console.error("Seek error:",e))},[a,c]);Object(n.useEffect)(()=>{const e=e=>{if("INPUT"!==e.target.tagName&&"TEXTAREA"!==e.target.tagName)switch(e.code){case"Space":e.preventDefault(),_();break;case"KeyR":e.preventDefault(),D();break;case"ArrowRight":e.ctrlKey||e.metaKey?(e.preventDefault(),M()):e.shiftKey?(e.preventDefault(),L(10)):(e.preventDefault(),R(10));break;case"ArrowLeft":e.ctrlKey||e.metaKey?(e.preventDefault(),$()):e.shiftKey?(e.preventDefault(),L(-10)):(e.preventDefault(),R(-10))}};return document.addEventListener("keydown",e),()=>{document.removeEventListener("keydown",e)}},[_,M,$,R,L,D]);const T=e=>`${Math.floor(e/6e4)}:${Math.floor(e%6e4/1e3).toString().padStart(2,"0")}`,I=e=>{const t=Math.floor(e/6e4),a=Math.floor(e%6e4/1e3),n=Math.floor(e%1e3/10);return`${t}:${a.toString().padStart(2,"0")}:${n.toString().padStart(2,"0")}`},P=(e,t)=>{w(t),e.preventDefault()},A=e=>{if(!v)return;const t=document.querySelector(".timeline").getBoundingClientRect(),a=Math.max(0,Math.min(1,(e.clientX-t.left)/t.width))*k;if("start"===v){const e=Math.min(a,m);d(e)}else if("end"===v){const e=Math.max(a,c);p(e)}},K=Object(n.useCallback)(()=>{"start"===v&&b&&a&&a.seek(c).catch(e=>console.error("Seek error:",e)),C.current=!0,setTimeout(()=>{C.current=!1},100),w(null)},[v,b,a,c]);return Object(n.useEffect)(()=>{if(v)return document.addEventListener("mousemove",A),document.addEventListener("mouseup",K),()=>{document.removeEventListener("mousemove",A),document.removeEventListener("mouseup",K)}},[v,A,K]),r.a.createElement("div",{className:"App"},e?r.a.createElement("div",{className:"player-container"},l&&r.a.createElement("div",{className:"track-info"},r.a.createElement("h2",null,l.name),r.a.createElement("h3",null,l.artist)),r.a.createElement("div",{className:"timeline-container"},r.a.createElement("div",{style:{display:"flex",justifyContent:"space-between",marginBottom:"5px"}},r.a.createElement("span",null,T(y)),r.a.createElement("span",null,T(k))),r.a.createElement("div",{className:"timeline",onClick:e=>{if(C.current)return;const t=e.currentTarget.getBoundingClientRect(),n=(e.clientX-t.left)/t.width,r=n*k,o=m/k,l=2/t.width;Math.abs(n-o)<l||a.seek(r)},style:{position:"relative",height:"40px",background:"#ddd",cursor:"pointer",borderRadius:"20px",margin:"0 0 10px 0"}},r.a.createElement("div",{className:"progress",style:{position:"absolute",left:0,top:0,height:"100%",width:`${y/k*100}%`,background:"#1db954",borderRadius:"20px"}}),r.a.createElement("div",{className:"loop-region",style:{position:"absolute",left:`${c/k*100}%`,width:`${(m-c)/k*100}%`,height:"100%",background:"rgba(29, 185, 84, 0.3)",borderRadius:"20px"}}),r.a.createElement("div",{className:"loop-start",style:{position:"absolute",left:`${c/k*100}%`,height:"60px",top:"-10px",width:"4px",background:"#ffffff",border:"2px solid #1db954",cursor:"ew-resize",zIndex:2,borderRadius:"2px"},onMouseDown:e=>P(e,"start")}),r.a.createElement("div",{className:"loop-end",style:{position:"absolute",left:`${m/k*100}%`,height:"60px",top:"-10px",width:"4px",background:"#ffffff",border:"2px solid #1db954",cursor:"ew-resize",zIndex:2,borderRadius:"2px"},onMouseDown:e=>P(e,"end")})),r.a.createElement("div",{className:"time-display",style:{position:"relative",height:"20px",marginTop:"15px"}},Math.abs((m-c)/k)>.1?r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{className:"timestamp-container",style:{left:`${c/k*100}%`,color:"#1db954",fontWeight:"bold",cursor:"default"},title:"Use arrow keys to adjust start, Shift+arrow keys to adjust end"},r.a.createElement("span",null,I(c))),r.a.createElement("div",{className:"timestamp-container",style:{left:`${m/k*100}%`,color:"#1db954",fontWeight:"bold",cursor:"default"},title:"Use arrow keys to adjust start, Shift+arrow keys to adjust end"},r.a.createElement("span",null,I(m)))):r.a.createElement("div",{style:{position:"absolute",left:`${(c+m)/2/k*100}%`,transform:"translateX(-50%)",color:"#1db954",fontWeight:"bold"}},I(c)," - ",I(m)))),j&&r.a.createElement("div",{className:"loop-inputs"},r.a.createElement("label",null,"Loop Start (ms):",r.a.createElement("input",{type:"number",ref:x,value:c,onChange:e=>{const t=Number(e.target.value);d(t),a&&a.seek(t).catch(e=>console.error("Seek error:",e))}})),r.a.createElement("label",null,"Loop End (ms):",r.a.createElement("input",{type:"number",ref:O,value:m,onChange:e=>{const t=Number(e.target.value);p(t),a&&a.seek(t).catch(e=>console.error("Seek error:",e))}}))),r.a.createElement("div",{className:"controls",style:{marginTop:"20px",display:"flex",justifyContent:"center",gap:"15px",alignItems:"center"}},r.a.createElement("button",{onClick:$,className:"control-button","aria-label":"Previous track",title:"Previous Track"},"\u23ee"),r.a.createElement("button",{onClick:_,className:"control-button","aria-label":"Play or pause",title:(null===g||void 0===g?void 0:g.paused)?"Play":"Pause"},(null===g||void 0===g?void 0:g.paused)?"\u25b6":"\u23f8"),r.a.createElement("button",{onClick:M,className:"control-button","aria-label":"Next track",title:"Next Track"},"\u23ed"),r.a.createElement("button",{onClick:()=>f(!b),className:`control-button ${b?"active":""}`,"aria-label":"Toggle loop",title:b?"Stop Loop":"Start Loop"},"\ud83d\udd01")),r.a.createElement(i,null)," "):r.a.createElement("button",{onClick:()=>{window.location.href=`https://accounts.spotify.com/authorize?client_id=90578a866be642ed97064a098d97fecd&redirect_uri=${encodeURIComponent("https://karthikg89.github.io/spotify-loop-player/")}&scope=${encodeURIComponent(["user-read-playback-state","user-modify-playback-state","streaming"].join(" "))}&response_type=token`}},"Login with Spotify"))};l.a.createRoot(document.getElementById("root")).render(r.a.createElement(r.a.StrictMode,null,r.a.createElement(d,null)))}],[[4,1,2]]]);
//# sourceMappingURL=main.ad4ea07e.chunk.js.map