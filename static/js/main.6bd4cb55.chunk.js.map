{"version":3,"sources":["Shortcuts.js","App.js","index.js"],"names":["Shortcuts","React","createElement","className","spotifyApi","SpotifyWebApi","App","token","setToken","useState","player","setPlayer","currentTrack","setCurrentTrack","loopStart","setLoopStart","loopEnd","setLoopEnd","isLooping","setIsLooping","currentTime","setCurrentTime","duration","setDuration","isDragging","setIsDragging","playerState","setPlayerState","showLoopControls","setShowLoopControls","countInEnabled","setCountInEnabled","isCountingIn","setIsCountingIn","bpm","setBpm","loopStartRef","useRef","loopEndRef","justFinishedDragging","countInTimeoutRef","audioContextRef","oscillatorRef","useEffect","hash","window","location","substring","split","reduce","initial","item","parts","decodeURIComponent","access_token","setAccessToken","document","getElementById","script","id","src","async","body","appendChild","onSpotifyWebPlaybackSDKReady","Spotify","Player","name","getOAuthToken","cb","addListener","_ref","device_id","console","log","transferMyPlayback","connect","state","track","track_window","current_track","artist","artists","uri","handleCountIn","useCallback","current","clearTimeout","stop","close","pause","AudioContext","createOscillator","gainNode","createGain","destination","beatDuration","i","time","frequency","setValueAtTime","gain","linearRampToValueAtTime","start","setTimeout","seek","resume","timeInterval","setInterval","getCurrentState","position","catch","err","error","clearInterval","adjustLoopStart","adjustment","newStart","Math","min","adjustLoopEnd","newEnd","max","handleNextTrack","nextTrack","handlePreviousTrack","previousTrack","handlePlayPause","paused","handleRestartLoop","toggleLoop","handleKeyPress","e","target","tagName","code","preventDefault","ctrlKey","metaKey","shiftKey","addEventListener","removeEventListener","formatCurrentTime","ms","floor","toString","padStart","formatLoopTime","minutes","seconds","hundredths","handleLoopPointMouseDown","point","handleMouseMove","rect","querySelector","getBoundingClientRect","timePosition","clientX","left","width","handleMouseUp","style","display","justifyContent","marginBottom","onClick","currentTarget","clickPosition","clickTime","endPosition","tolerance","abs","height","background","cursor","borderRadius","margin","top","border","zIndex","onMouseDown","marginTop","Fragment","color","fontWeight","title","transform","type","ref","value","onChange","newValue","Number","gap","alignItems","aria-label","newBpm","disabled","handleLogin","href","encodeURIComponent","join","ReactDOM","createRoot","render","StrictMode"],"mappings":"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","file":"static/js/main.6bd4cb55.chunk.js","sourcesContent":["import React from 'react';\nimport './Shortcuts.css'; // Create a separate CSS file for styling\n\nconst Shortcuts = () => {\n  return (\n    <div className=\"shortcuts-container\">\n      <div className=\"shortcuts-header\">\n        <h2>Keyboard Shortcuts</h2>\n        <span className=\"arrow\">▼</span>\n      </div>\n      <div className=\"shortcuts-list\">\n        <ul>\n          <li>\n            <span className=\"key\">Space</span>\n            <span className=\"colon\">:</span>\n            <span className=\"description\">Play/Pause</span>\n          </li>\n          <li>\n            <span className=\"key\">Arrow Left</span>\n            <span className=\"colon\">:</span>\n            <span className=\"description\">Move Start Loop Backward by 10ms</span>\n          </li>\n          <li>\n            <span className=\"key\">Arrow Right</span>\n            <span className=\"colon\">:</span>\n            <span className=\"description\">Move Start Loop Forward by 10ms</span>\n          </li>\n          <li>\n            <span className=\"key\">Shift + Arrow Left</span>\n            <span className=\"colon\">:</span>\n            <span className=\"description\">Move End Loop Backward by 10ms</span>\n          </li>\n          <li>\n            <span className=\"key\">Shift + Arrow Right</span>\n            <span className=\"colon\">:</span>\n            <span className=\"description\">Move End Loop Forward by 10ms</span>\n          </li>\n          <li>\n            <span className=\"key\">R</span>\n            <span className=\"colon\">:</span>\n            <span className=\"description\">Restart Loop (with count-in if enabled)</span>\n          </li>\n        </ul>\n      </div>\n    </div>\n  );\n};\n\nexport default Shortcuts; ","import React, { useState, useEffect, useRef, useCallback } from 'react';\nimport SpotifyWebApi from 'spotify-web-api-js';\nimport './App.css';\nimport Shortcuts from './Shortcuts'; // Import the Shortcuts component\n\nconst spotifyApi = new SpotifyWebApi();\n\nfunction App() {\n  const [token, setToken] = useState(null);\n  const [player, setPlayer] = useState(null);\n  const [currentTrack, setCurrentTrack] = useState(null);\n  const [loopStart, setLoopStart] = useState(0);\n  const [loopEnd, setLoopEnd] = useState(0);\n  const [isLooping, setIsLooping] = useState(false);\n  const [currentTime, setCurrentTime] = useState(0);\n  const [duration, setDuration] = useState(0);\n  const [isDragging, setIsDragging] = useState(null); // 'start', 'end', or null\n  const [playerState, setPlayerState] = useState(null);\n  const [showLoopControls, setShowLoopControls] = useState(false);\n  const [countInEnabled, setCountInEnabled] = useState(false);\n  const [isCountingIn, setIsCountingIn] = useState(false);\n  const [bpm, setBpm] = useState(120);\n\n  const loopStartRef = useRef(null);\n  const loopEndRef = useRef(null);\n  const justFinishedDragging = useRef(false);\n  const countInTimeoutRef = useRef(null);\n  const audioContextRef = useRef(null);\n  const oscillatorRef = useRef(null);\n\n  useEffect(() => {\n    // Get token from URL params (after Spotify auth redirect)\n    const hash = window.location.hash\n      .substring(1)\n      .split('&')\n      .reduce((initial, item) => {\n        let parts = item.split('=');\n        initial[parts[0]] = decodeURIComponent(parts[1]);\n        return initial;\n      }, {});\n\n    if (hash.access_token) {\n      setToken(hash.access_token);\n      spotifyApi.setAccessToken(hash.access_token);\n    }\n  }, []);\n\n  useEffect(() => {\n    if (!token) return; // Only proceed if we have a token\n    \n    // Check if script is already loaded\n    if (!document.getElementById('spotify-player')) {\n      const script = document.createElement(\"script\");\n      script.id = 'spotify-player'; // Add an ID to check for existence\n      script.src = \"https://sdk.scdn.co/spotify-player.js\";\n      script.async = true;\n      document.body.appendChild(script);\n\n      window.onSpotifyWebPlaybackSDKReady = () => {\n        const player = new window.Spotify.Player({\n          name: 'Loop Player',\n          getOAuthToken: cb => { cb(token); }\n        });\n\n        player.addListener('ready', ({ device_id }) => {\n          console.log('Ready with Device ID', device_id);\n          // Transfer playback to our player\n          spotifyApi.transferMyPlayback([device_id]);\n        });\n\n        player.connect();\n        setPlayer(player);\n      };\n    }\n  }, [token]);\n\n  // Update the track state listener useEffect\n  useEffect(() => {\n    if (player) {\n      player.addListener('player_state_changed', (state) => {\n        if (state) {\n          setPlayerState(state);\n          const track = state.track_window.current_track;\n          setCurrentTrack({\n            name: track.name,\n            artist: track.artists[0].name,\n            duration: state.duration,\n            uri: track.uri,\n            id: track.id\n          });\n          setDuration(state.duration);\n        }\n      });\n    }\n  }, [player]);\n\n  // Move handleCountIn above the loop checking effect\n  const handleCountIn = useCallback(async () => {\n    if (!player) return;\n    \n    // If counting in, cancel it\n    if (isCountingIn) {\n      if (countInTimeoutRef.current) {\n        clearTimeout(countInTimeoutRef.current);\n        countInTimeoutRef.current = null;\n      }\n      if (oscillatorRef.current) {\n        oscillatorRef.current.stop();\n        oscillatorRef.current = null;\n      }\n      if (audioContextRef.current) {\n        audioContextRef.current.close();\n        audioContextRef.current = null;\n      }\n      setIsCountingIn(false);\n      return;\n    }\n    \n    // Pause playback before starting count-in\n    await player.pause();\n    setIsCountingIn(true);\n    \n    audioContextRef.current = new AudioContext();\n    oscillatorRef.current = audioContextRef.current.createOscillator();\n    const gainNode = audioContextRef.current.createGain();\n    \n    oscillatorRef.current.connect(gainNode);\n    gainNode.connect(audioContextRef.current.destination);\n    \n    const beatDuration = 60000 / bpm; // Use the bpm state here\n    \n    // Play 4 clicks\n    for (let i = 0; i < 4; i++) {\n      const time = audioContextRef.current.currentTime + (i * beatDuration / 1000);\n      \n      // Higher pitch for first beat\n      oscillatorRef.current.frequency.setValueAtTime(i === 0 ? 1000 : 800, time);\n      \n      gainNode.gain.setValueAtTime(0, time);\n      gainNode.gain.linearRampToValueAtTime(0.5, time + 0.001);\n      gainNode.gain.linearRampToValueAtTime(0, time + 0.1);\n    }\n    \n    oscillatorRef.current.start();\n    oscillatorRef.current.stop(audioContextRef.current.currentTime + (4 * beatDuration / 1000));\n    \n    // Start playback after count-in\n    countInTimeoutRef.current = setTimeout(async () => {\n      setIsCountingIn(false);\n      countInTimeoutRef.current = null;\n      oscillatorRef.current = null;\n      audioContextRef.current = null;\n      \n      if (player) {\n        await player.seek(loopStart);\n        await player.resume();\n        setIsLooping(true);\n      }\n    }, 4 * beatDuration);\n  }, [player, loopStart, isCountingIn, bpm]);\n\n  // Then the loop checking effect\n  useEffect(() => {\n    if (player) {\n      const timeInterval = setInterval(async () => {\n        const state = await player.getCurrentState();\n        if (state) {\n          setCurrentTime(state.position);\n          \n          // Only seek to start position if looping is enabled and we're past the end\n          if (isLooping && state.position >= loopEnd && !isDragging && !isCountingIn) {\n            if (countInEnabled) {\n              handleCountIn(); // Use count-in when enabled\n            } else {\n              player.seek(loopStart).catch(err => console.error('Seek error:', err));\n            }\n          }\n        }\n      }, 100);\n\n      return () => clearInterval(timeInterval);\n    }\n  }, [player, isLooping, loopStart, loopEnd, isDragging, countInEnabled, handleCountIn, isCountingIn]);\n\n  // Define the adjustment handlers with useCallback\n  const adjustLoopStart = useCallback((adjustment) => {\n    const newStart = Math.min(loopStart + adjustment, loopEnd);\n    setLoopStart(newStart);\n    // Always seek when adjusting start with arrow keys\n    if (player) {\n      player.seek(newStart).catch(err => console.error('Seek error:', err));\n    }\n  }, [loopStart, loopEnd, setLoopStart, player]);\n\n  const adjustLoopEnd = useCallback((adjustment) => {\n    const newEnd = Math.max(loopEnd + adjustment, loopStart);\n    setLoopEnd(newEnd);\n  }, [loopEnd, loopStart, setLoopEnd]);\n\n  const handleNextTrack = useCallback(async () => {\n    if (!player) return;\n    setIsLooping(false);\n    await player.nextTrack();\n  }, [player, setIsLooping]);\n\n  const handlePreviousTrack = useCallback(async () => {\n    if (!player) return;\n    setIsLooping(false);\n    await player.previousTrack();\n  }, [player, setIsLooping]);\n\n  const handlePlayPause = useCallback(async () => {\n    if (!player) return;\n    const state = await player.getCurrentState();\n    if (state?.paused) {\n      await player.resume();\n    } else {\n      await player.pause();\n    }\n  }, [player]);\n\n  // Add the restart loop handler with useCallback\n  const handleRestartLoop = useCallback(() => {\n    if (player) {\n      player.seek(loopStart).catch(err => console.error('Seek error:', err));\n    }\n  }, [player, loopStart]);\n\n  // Update the loop toggle handler\n  const toggleLoop = useCallback(() => {\n    setIsLooping(!isLooping);\n    if (!isLooping && player) {\n      // When enabling loop, seek to start position\n      player.seek(loopStart).catch(err => console.error('Seek error:', err));\n    }\n  }, [isLooping, player, loopStart]);\n\n  // Clean up on unmount\n  useEffect(() => {\n    return () => {\n      if (countInTimeoutRef.current) {\n        clearTimeout(countInTimeoutRef.current);\n      }\n      if (oscillatorRef.current) {\n        oscillatorRef.current.stop();\n      }\n      if (audioContextRef.current) {\n        audioContextRef.current.close();\n      }\n    };\n  }, []);\n\n  // Then the useEffect that uses handleCountIn\n  useEffect(() => {\n    const handleKeyPress = (e) => {\n      if (e.target.tagName === 'INPUT' || e.target.tagName === 'TEXTAREA') return;\n      \n      const adjustment = 10; // Fixed 10ms adjustment\n\n      switch(e.code) {\n        case 'Space':\n          e.preventDefault();\n          handlePlayPause();\n          break;\n        case 'KeyR': // Update handler for 'r' key\n          e.preventDefault();\n          if (countInEnabled) {\n            handleCountIn();\n          } else {\n            handleRestartLoop();\n          }\n          break;\n        case 'ArrowRight':\n          if (e.ctrlKey || e.metaKey) {\n            e.preventDefault();\n            handleNextTrack();\n          } else if (e.shiftKey) {\n            e.preventDefault();\n            adjustLoopEnd(adjustment);\n          } else {\n            e.preventDefault();\n            adjustLoopStart(adjustment);\n          }\n          break;\n        case 'ArrowLeft':\n          if (e.ctrlKey || e.metaKey) {\n            e.preventDefault();\n            handlePreviousTrack();\n          } else if (e.shiftKey) {\n            e.preventDefault();\n            adjustLoopEnd(-adjustment);\n          } else {\n            e.preventDefault();\n            adjustLoopStart(-adjustment);\n          }\n          break;\n        default:\n          break;\n      }\n    };\n\n    document.addEventListener('keydown', handleKeyPress);\n    \n    return () => {\n      document.removeEventListener('keydown', handleKeyPress);\n    };\n  }, [handlePlayPause, handleNextTrack, handlePreviousTrack, adjustLoopStart, adjustLoopEnd, handleRestartLoop, handleCountIn, countInEnabled]);\n\n  const handleLogin = () => {\n    const CLIENT_ID = '90578a866be642ed97064a098d97fecd';\n    // const REDIRECT_URI = 'http://localhost:3000/callback';\n    const REDIRECT_URI = 'https://karthikg89.github.io/spotify-loop-player/'; // Production URI\n    const scopes = [\n      'user-read-playback-state',\n      'user-modify-playback-state',\n      'streaming'\n    ];\n\n    window.location.href = `https://accounts.spotify.com/authorize?client_id=${CLIENT_ID}&redirect_uri=${encodeURIComponent(REDIRECT_URI)}&scope=${encodeURIComponent(scopes.join(' '))}&response_type=token`;\n  };\n\n  const formatCurrentTime = (ms) => {\n    const minutes = Math.floor(ms / 60000);\n    const seconds = Math.floor((ms % 60000) / 1000);\n\n    return `${minutes}:${seconds.toString().padStart(2, '0')}`; // Format as mm:ss\n  };\n\n  const formatLoopTime = (ms) => {\n    const minutes = Math.floor(ms / 60000);\n    const seconds = Math.floor((ms % 60000) / 1000);\n    const hundredths = Math.floor((ms % 1000) / 10);\n\n    return `${minutes}:${seconds.toString().padStart(2, '0')}:${hundredths.toString().padStart(2, '0')}`; // Format as mm:ss:hh\n  };\n\n  const handleTimelineClick = (e) => {\n    if (justFinishedDragging.current) {\n      return;\n    }\n\n    const timeline = e.currentTarget;\n    const rect = timeline.getBoundingClientRect();\n    const clickPosition = (e.clientX - rect.left) / rect.width;\n    const clickTime = clickPosition * duration;\n    \n    // Check if click is near either loop marker (within 2px)\n    const startPosition = (loopStart / duration);\n    const endPosition = (loopEnd / duration);\n    const tolerance = 2 / rect.width; // Convert 2px to percentage\n    \n    // Only block seeking if we're near the end marker\n    if (Math.abs(clickPosition - endPosition) < tolerance) {\n      return; // Don't seek if clicking near end marker\n    }\n    \n    player.seek(clickTime);\n  };\n\n  const handleLoopPointMouseDown = (e, point) => {\n    setIsDragging(point);\n    // Prevent text selection while dragging\n    e.preventDefault();\n  };\n\n  const handleMouseMove = (e) => {\n    if (!isDragging) return;\n\n    const timeline = document.querySelector('.timeline');\n    const rect = timeline.getBoundingClientRect();\n    const position = Math.max(0, Math.min(1, (e.clientX - rect.left) / rect.width));\n    const timePosition = position * duration;\n\n    if (isDragging === 'start') {\n      const newStart = Math.min(timePosition, loopEnd);\n      setLoopStart(newStart);\n    } else if (isDragging === 'end') {\n      const newEnd = Math.max(timePosition, loopStart);\n      setLoopEnd(newEnd);\n    }\n  };\n\n  const handleMouseUp = useCallback(() => {\n    if (isDragging === 'start' && isLooping && player) {\n      // Only seek to start position if we were dragging the start marker and looping is active\n      player.seek(loopStart).catch(err => console.error('Seek error:', err));\n    }\n    justFinishedDragging.current = true;\n    // Reset the flag after a short delay\n    setTimeout(() => {\n      justFinishedDragging.current = false;\n    }, 100);\n    setIsDragging(null);\n  }, [isDragging, isLooping, player, loopStart]);\n\n  // Add this useEffect to handle mouse events\n  useEffect(() => {\n    if (isDragging) {\n      document.addEventListener('mousemove', handleMouseMove);\n      document.addEventListener('mouseup', handleMouseUp);\n      \n      return () => {\n        document.removeEventListener('mousemove', handleMouseMove);\n        document.removeEventListener('mouseup', handleMouseUp);\n      };\n    }\n  }, [isDragging, handleMouseMove, handleMouseUp]);\n\n  return (\n    <div className=\"App\">\n      {!token ? (\n        <button onClick={handleLogin}>Login with Spotify</button>\n      ) : (\n        <div className=\"player-container\">\n          {currentTrack && (\n            <div className=\"track-info\">\n              <h2>{currentTrack.name}</h2>\n              <h3>{currentTrack.artist}</h3>\n            </div>\n          )}\n\n          <div className=\"timeline-container\">\n            {/* Move current time and duration above the timeline */}\n            <div style={{ \n              display: 'flex', \n              justifyContent: 'space-between',\n              marginBottom: '5px'\n            }}>\n              <span>{formatCurrentTime(currentTime)}</span>\n              <span>{formatCurrentTime(duration)}</span>\n            </div>\n\n            <div \n              className=\"timeline\" \n              onClick={handleTimelineClick}\n              style={{ \n                position: 'relative', \n                height: '40px', \n                background: '#ddd', \n                cursor: 'pointer',\n                borderRadius: '20px',\n                margin: '0 0 10px 0'  // Adjusted margin\n              }}\n            >\n              {/* Playback progress */}\n              <div \n                className=\"progress\"\n                style={{\n                  position: 'absolute',\n                  left: 0,\n                  top: 0,\n                  height: '100%',\n                  width: `${(currentTime / duration) * 100}%`,\n                  background: '#1db954',\n                  borderRadius: '20px'\n                }}\n              />\n              \n              {/* Loop region */}\n              <div \n                className=\"loop-region\"\n                style={{\n                  position: 'absolute',\n                  left: `${(loopStart / duration) * 100}%`,\n                  width: `${((loopEnd - loopStart) / duration) * 100}%`,\n                  height: '100%',\n                  background: 'rgba(29, 185, 84, 0.3)',\n                  borderRadius: '20px'\n                }}\n              />\n\n              {/* Loop markers */}\n              <div \n                className=\"loop-start\"\n                style={{\n                  position: 'absolute',\n                  left: `${(loopStart / duration) * 100}%`,\n                  height: '60px',\n                  top: '-10px',\n                  width: '4px',\n                  background: '#ffffff',\n                  border: '2px solid #1db954',\n                  cursor: 'ew-resize',\n                  zIndex: 2,\n                  borderRadius: '2px'\n                }}\n                onMouseDown={(e) => handleLoopPointMouseDown(e, 'start')}\n              />\n              <div \n                className=\"loop-end\"\n                style={{\n                  position: 'absolute',\n                  left: `${(loopEnd / duration) * 100}%`,\n                  height: '60px',\n                  top: '-10px',\n                  width: '4px',\n                  background: '#ffffff',\n                  border: '2px solid #1db954',\n                  cursor: 'ew-resize',\n                  zIndex: 2,\n                  borderRadius: '2px'\n                }}\n                onMouseDown={(e) => handleLoopPointMouseDown(e, 'end')}\n              />\n            </div>\n\n            {/* Loop timestamps only */}\n            <div className=\"time-display\" style={{ \n              position: 'relative',\n              height: '20px',\n              marginTop: '15px'\n            }}>\n              {Math.abs((loopEnd - loopStart) / duration) > 0.1 ? (\n                <>\n                  <div className=\"timestamp-container\" \n                    style={{ \n                      left: `${(loopStart / duration) * 100}%`,\n                      color: '#1db954',\n                      fontWeight: 'bold',\n                      cursor: 'default'\n                    }}\n                    title=\"Use arrow keys to adjust start, Shift+arrow keys to adjust end\"\n                  >\n                    <span>{formatLoopTime(loopStart)}</span>\n                  </div>\n                  <div className=\"timestamp-container\" \n                    style={{ \n                      left: `${(loopEnd / duration) * 100}%`,\n                      color: '#1db954',\n                      fontWeight: 'bold',\n                      cursor: 'default'\n                    }}\n                    title=\"Use arrow keys to adjust start, Shift+arrow keys to adjust end\"\n                  >\n                    <span>{formatLoopTime(loopEnd)}</span>\n                  </div>\n                </>\n              ) : (\n                <div style={{ \n                  position: 'absolute', \n                  left: `${((loopStart + loopEnd) / 2 / duration) * 100}%`,\n                  transform: 'translateX(-50%)',\n                  color: '#1db954',\n                  fontWeight: 'bold'\n                }}>\n                  {formatLoopTime(loopStart)} - {formatLoopTime(loopEnd)}\n                </div>\n              )}\n            </div>\n          </div>\n\n          {showLoopControls && (\n            <div className=\"loop-inputs\">\n              <label>\n                Loop Start (ms):\n                <input\n                  type=\"number\"\n                  ref={loopStartRef}\n                  value={loopStart}\n                  onChange={(e) => {\n                    const newValue = Number(e.target.value);\n                    setLoopStart(newValue);\n                    // Optionally, you can also seek to the new loop start position\n                    if (player) {\n                      player.seek(newValue).catch(err => console.error('Seek error:', err));\n                    }\n                  }}\n                />\n              </label>\n              <label>\n                Loop End (ms):\n                <input\n                  type=\"number\"\n                  ref={loopEndRef}\n                  value={loopEnd}\n                  onChange={(e) => {\n                    const newValue = Number(e.target.value);\n                    setLoopEnd(newValue);\n                    // Optionally, you can also seek to the new loop end position\n                    if (player) {\n                      player.seek(newValue).catch(err => console.error('Seek error:', err));\n                    }\n                  }}\n                />\n              </label>\n            </div>\n          )}\n\n          <div className=\"controls\" style={{ \n            marginTop: '20px',\n            display: 'flex',\n            justifyContent: 'center',\n            gap: '15px',\n            alignItems: 'center'\n          }}>\n            <button \n              onClick={handlePreviousTrack}\n              className=\"control-button\"\n              aria-label=\"Previous track\"\n              title=\"Previous Track\"\n            >\n              ⏮\n            </button>\n            \n            <button \n              onClick={handlePlayPause} \n              className=\"control-button\"\n              aria-label=\"Play or pause\"\n              title={playerState?.paused ? \"Play\" : \"Pause\"}\n            >\n              {playerState?.paused ? \"▶\" : \"⏸\"}\n            </button>\n            \n            <button \n              onClick={handleNextTrack}\n              className=\"control-button\"\n              aria-label=\"Next track\"\n              title=\"Next Track\"\n            >\n              ⏭\n            </button>\n\n            <button \n              onClick={toggleLoop}\n              className={`control-button ${isLooping ? 'active' : ''}`}\n              aria-label=\"Toggle loop\"\n              title={isLooping ? \"Stop Loop\" : \"Start Loop\"}\n            >\n              🔁\n            </button>\n\n            <div className={`count-in-group ${countInEnabled ? 'count-in-expanded' : ''}`}>\n              <button\n                onClick={() => setCountInEnabled(!countInEnabled)}\n                className={`control-button ${countInEnabled ? 'active' : ''}`}\n                title=\"Toggle Count-in\"\n              >\n                🎵\n              </button>\n              \n              {countInEnabled && (\n                <>\n                  <input\n                    type=\"number\"\n                    value={bpm}\n                    onChange={(e) => {\n                      const newBpm = Math.max(1, Math.min(300, Number(e.target.value)));\n                      setBpm(newBpm);\n                    }}\n                    title=\"BPM for count-in\"\n                  />\n                  <label>BPM</label>\n                  <button\n                    onClick={handleCountIn}\n                    className=\"control-button\"\n                    disabled={isCountingIn}\n                    title=\"Start with Count-in\"\n                  >\n                    {isCountingIn ? '1-2-3-4' : 'Start'}\n                  </button>\n                </>\n              )}\n            </div>\n          </div>\n\n          <Shortcuts /> {/* Add the Shortcuts component here */}\n        </div>\n      )}\n    </div>\n  );\n}\n\nexport default App; ","import React from 'react';\nimport ReactDOM from 'react-dom/client';\nimport './index.css';\nimport App from './App';\n\nconst root = ReactDOM.createRoot(document.getElementById('root'));\nroot.render(\n  <React.StrictMode>\n    <App />\n  </React.StrictMode>\n);\n"],"sourceRoot":""}